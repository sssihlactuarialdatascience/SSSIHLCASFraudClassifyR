<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SSSIHLCASFraudClassifyR">
<title>Mapping Triggers to Data • SSSIHLCASFraudClassifyR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mapping Triggers to Data">
<meta property="og:description" content="SSSIHLCASFraudClassifyR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SSSIHLCASFraudClassifyR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/SSSIHLCASFraudClassifyR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_data_pre_processing.html">Data Pre-processing</a>
    <a class="dropdown-item" href="../articles/02_mapping_triggers_to_data.html">Mapping Triggers to Data</a>
    <a class="dropdown-item" href="../articles/03_fraud_classification_decision_trees.html">Fraud Classification with Decision Trees</a>
    <a class="dropdown-item" href="../articles/04_fraud_classification_glm.html">Fraud Classification with GLM</a>
    <a class="dropdown-item" href="../articles/05_fraud_classification_naive_bayes.html">Fraud Classification with Naive Bayes</a>
    <a class="dropdown-item" href="../articles/06_fraud_classification_random_forest.html">Fraud Classification with Random Forest</a>
    <a class="dropdown-item" href="../articles/07_fraud_classification_xg_boost.html">Fraud Classification with XG Boost</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Mapping Triggers to Data</h1>
            
      
      
      <div class="d-none name"><code>02_mapping_triggers_to_data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SSSIHLCASFraudClassifyR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">smotefamily</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/ncordon/imbalance" class="external-link">imbalance</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ROSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wrathematics/coop" class="external-link">coop</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/radiant-rstats/radiant.data/" class="external-link">radiant.data</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">claims_data_sample</span>, package <span class="op">=</span> <span class="st">"SSSIHLCASFraudClassifyR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">trigger_data</span>, package <span class="op">=</span> <span class="st">"SSSIHLCASFraudClassifyR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">location_distance</span>, package <span class="op">=</span> <span class="st">"SSSIHLCASFraudClassifyR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hospital_list</span>, package <span class="op">=</span> <span class="st">"SSSIHLCASFraudClassifyR"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="mapping-triggers-to-claims-data">Mapping triggers to claims data<a class="anchor" aria-label="anchor" href="#mapping-triggers-to-claims-data"></a>
</h2>
<ul>
<li><p>These trigger maps add additional columns 0’s and 1’s to the
dataset.</p></li>
<li><p>“1”represents a flag raised by the trigger.</p></li>
</ul>
<div class="section level3">
<h3 id="claim_amount_trigger_map">claim_amount_trigger_map<a class="anchor" aria-label="anchor" href="#claim_amount_trigger_map"></a>
</h3>
<p>There is typically a predetermined amount agreed upon by the insurer
and medical service provider for each procedure, particularly for
cashless claim processing. If the claim amount exceeds this established
procedure-specific amount, it will raise a flag.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">trigger_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">primary_procedure_code</span>, <span class="va">package_amount_trigger</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/claim_amount_trigger_map.html">claim_amount_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">claims_dataset</span>,</span>
<span>    claim_paid_field <span class="op">=</span> <span class="st">"approved_allowed_amount"</span>,</span>
<span>    triggers_file <span class="op">=</span> <span class="va">data</span>,</span>
<span>    procedure_code <span class="op">=</span> <span class="st">"primary_procedure_code"</span>,</span>
<span>    procedure_amount_field <span class="op">=</span> <span class="st">"package_amount_trigger"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">claim_amount_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  1.0000  1.0000  0.9962  1.0000  1.0000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hosp_days_trigger_map">hosp_days_trigger_map<a class="anchor" aria-label="anchor" href="#hosp_days_trigger_map"></a>
</h3>
<p>A specific number of days that a claimant can be admitted to the
hospital is deemed reasonable for each procedure. If the actual number
of days spent in the hospital exceeds this reasonable duration for the
given procedure, the function will raise a flag.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">trigger_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">primary_procedure_code</span>,</span>
<span>                <span class="va">admission_days_trigger</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/hosp_days_trigger_map.html">hosp_days_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    no_of_days_stayed <span class="op">=</span> <span class="st">"no_of_days_stayed"</span>,</span>
<span>    triggers_file <span class="op">=</span> <span class="va">data</span>,</span>
<span>    procedure_code <span class="op">=</span> <span class="st">"primary_procedure_code"</span>,</span>
<span>    admission_days_trigger <span class="op">=</span> <span class="st">"admission_days_trigger"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">hosp_days_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  1.0000  1.0000  0.7871  1.0000  1.0000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="age_trigger_map">age_trigger_map<a class="anchor" aria-label="anchor" href="#age_trigger_map"></a>
</h3>
<p>The triggers file includes age ranges that are considered reasonable
for undergoing a particular medical procedure. This function raises a
flag for all claimants whose age falls outside of this range. In order
for this function to operate correctly, the age must be consistently
specified in both the claims_file and the triggers_file.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">trigger_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lower_age_limit</span>, <span class="va">upper_age_limit</span>, <span class="va">primary_procedure_code</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">primary_procedure_code</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">primary_procedure_code</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/age_trigger_map.html">age_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    age_column_name <span class="op">=</span> <span class="st">"patient_age"</span>,</span>
<span>    triggers_file <span class="op">=</span> <span class="va">data</span>,</span>
<span>    lower_age_limit <span class="op">=</span> <span class="st">"lower_age_limit"</span>,</span>
<span>    upper_age_limit <span class="op">=</span> <span class="st">"upper_age_limit"</span>,</span>
<span>    procedure_code <span class="op">=</span> <span class="st">"primary_procedure_code"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">age_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;       0       0       0       0       0       0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gender_trigger_map">gender_trigger_map<a class="anchor" aria-label="anchor" href="#gender_trigger_map"></a>
</h3>
<p>Certain medical procedures are specific to a particular gender. If a
procedure is performed on a claimant of the wrong gender, this function
raises a flag. For instance, a gynecological procedure performed on a
male claimant would trigger a warning. To enable this function to
operate correctly, the gender must be specified consistently in both the
claims_file and the triggers_file.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">trigger_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">primary_procedure_code</span>, <span class="va">gender_trigger</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/gender_trigger_map.html">gender_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    gender_column_name <span class="op">=</span> <span class="st">"gender_code"</span>,</span>
<span>    triggers_file <span class="op">=</span> <span class="va">data</span>,</span>
<span>    procedure_code <span class="op">=</span> <span class="st">"primary_procedure_code"</span>,</span>
<span>    gender_trigger <span class="op">=</span> <span class="st">"gender_trigger"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">gender_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.00000 0.00000 0.00000 0.01805 0.00000 1.00000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="claim_count_trigger_map">claim_count_trigger_map<a class="anchor" aria-label="anchor" href="#claim_count_trigger_map"></a>
</h3>
<p>The frequency of receiving a particular medical treatment is
typically limited for policyholders, depending on the nature of the
treatment. If a policyholder has undergone a particular treatment an
unreasonably high number of times, it may be investigated for fraud.
This function detects all policyholders who have received a given
treatment excessively and raises flag.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">trigger_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">primary_procedure_code</span>, <span class="va">claim_count_trigger</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/claim_count_trigger_map.html">claim_count_trigger_map</a></span><span class="op">(</span></span>
<span>    claim_count <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    claim_count_pa <span class="op">=</span> <span class="st">"claim_count_pa"</span>,</span>
<span>    claim_count_trigger_file <span class="op">=</span> <span class="va">data</span>,</span>
<span>    procedure_code_field <span class="op">=</span> <span class="st">"primary_procedure_code"</span>,</span>
<span>    claim_count_trigger <span class="op">=</span> <span class="st">"claim_count_trigger"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">claim_count_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  0.0000  0.0000  0.4156  1.0000  1.0000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="close_prox_trigger_map">close_prox_trigger_map<a class="anchor" aria-label="anchor" href="#close_prox_trigger_map"></a>
</h3>
<p>A claim is in close proximity if the treatment start date is very
close to the policy commencement date. This function will raise a flag
for such claims.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">trigger_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">primary_procedure_code</span>, <span class="va">close_prox_days</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/close_prox_trigger_map.html">close_prox_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    treatment_start_date <span class="op">=</span> <span class="st">"treatment_start_date"</span>,</span>
<span>    policy_commencement_date <span class="op">=</span> <span class="st">"policy_commencement_date"</span>,</span>
<span>    triggers_file <span class="op">=</span> <span class="va">data</span>,</span>
<span>    procedure_code <span class="op">=</span> <span class="st">"primary_procedure_code"</span>,</span>
<span>    close_prox_days <span class="op">=</span> <span class="st">"close_prox_days"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">close_prox_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.00000 0.00000 0.00000 0.03352 0.00000 1.00000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="treatment_date_validity_trigger_map">treatment_date_validity_trigger_map<a class="anchor" aria-label="anchor" href="#treatment_date_validity_trigger_map"></a>
</h3>
<p>For each policy there is a commencement and termination date within
which the claim event(treatment) should occur. If the treatment date is
outside these dates, it will raise a flag.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/treatment_date_validity_trigger_map.html">treatment_date_validity_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    treatment_start_date_field <span class="op">=</span> <span class="st">"treatment_start_date"</span>,</span>
<span>    policy_commencement_date_field <span class="op">=</span> <span class="st">"policy_commencement_date"</span>,</span>
<span>    policy_termination_date_field <span class="op">=</span> <span class="st">"policy_termination_date"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">treatment_date_validity_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;       0       0       0       0       0       0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="claim_reported_delay_trigger_map">claim_reported_delay_trigger_map<a class="anchor" aria-label="anchor" href="#claim_reported_delay_trigger_map"></a>
</h3>
<p>For each policy there is a treatment start date and treatment end
date. The claim should be reported within the permissible days after
treatment end date (discharge date). If the claim reported date is
outside the permissible limit it will raise a flag.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/claim_reported_delay_trigger_map.html">claim_reported_delay_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    treatment_end_date_field <span class="op">=</span> <span class="st">"treatment_end_date"</span>,</span>
<span>    claim_reported_date_field <span class="op">=</span> <span class="st">"claim_reported_date"</span>,</span>
<span>    claim_delay_days <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">claim_reported_delay_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.00000 0.00000 0.00000 0.08356 0.00000 1.00000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hospital_empanelled_trigger_map">hospital_empanelled_trigger_map<a class="anchor" aria-label="anchor" href="#hospital_empanelled_trigger_map"></a>
</h3>
<p>Insurers typically select hospitals to serve their policyholders
through a process known as empanelment. During this process, the insurer
verifies that the hospital has the necessary facilities and agrees upon
a tariff for each treatment. If the hospital is not included in the list
of empaneled hospitals, a flag will be raised.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/hospital_empanelled_trigger_map.html">hospital_empanelled_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    hospital_id_field <span class="op">=</span> <span class="st">"medical_service_provider_id"</span>,</span>
<span>    empanelled_hospitals_list <span class="op">=</span> <span class="va">hospital_list</span>,</span>
<span>    empanelled_hospital_id <span class="op">=</span> <span class="st">"hosp_id"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">hospital_empanelled_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;       0       0       0       0       0       0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hospital_distance_trigger_map">hospital_distance_trigger_map<a class="anchor" aria-label="anchor" href="#hospital_distance_trigger_map"></a>
</h3>
<p>It is reasonable to anticipate that a policyholder will receive
treatment at the nearest hospital. If the distance between the
policyholder’s residence location and the hospital location exceeds a
predetermined threshold, this function will raise a flag.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/hospital_distance_trigger_map.html">hospital_distance_trigger_map</a></span><span class="op">(</span></span>
<span>    claims_file <span class="op">=</span> <span class="va">data_w_triggers</span>,</span>
<span>    residence_location_field <span class="op">=</span> <span class="st">"residence_location"</span>,</span>
<span>    hospital_location_field <span class="op">=</span> <span class="st">"hospital_location"</span>,</span>
<span>    hospital_distance_file <span class="op">=</span> <span class="va">location_distance</span>,</span>
<span>    residence_location_map <span class="op">=</span> <span class="st">"location_1"</span>,</span>
<span>    hospital_location_map <span class="op">=</span> <span class="st">"location_2"</span>,</span>
<span>    hospital_distance_field <span class="op">=</span> <span class="st">"distance"</span>,</span>
<span>    distance_threshold <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">hospital_distance_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  0.0000  0.0000  0.2882  1.0000  1.0000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="preparing-input-data-with-triggers">Preparing Input data with triggers<a class="anchor" aria-label="anchor" href="#preparing-input-data-with-triggers"></a>
</h2>
<div class="section level3">
<h3 id="reducing-dimensionality-of-character-columns">Reducing dimensionality of character columns<a class="anchor" aria-label="anchor" href="#reducing-dimensionality-of-character-columns"></a>
</h3>
<ul>
<li><p>We removed the columns that do not contribute in predicting the
fraud.</p></li>
<li><p>In columns with too many categories only the top values which
contributed the most were considered and remaining categories were taken
as one category. This had to be done since encoding such categorical
columns would bloat the data set.</p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Considering top 20 unique values from certain columns with large unique values</span></span>
<span></span>
<span><span class="co"># medical service provider id</span></span>
<span><span class="va">mspid</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data_w_triggers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">medical_service_provider_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mspid</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mspid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3289588</span></span>
<span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data_w_triggers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    medical_service_provider_id <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>        <span class="va">medical_service_provider_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mspid</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">medical_service_provider_id</span>,</span>
<span>        <span class="va">medical_service_provider_id</span>,</span>
<span>        <span class="st">"Others"</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">insured_id</span>,</span>
<span>      <span class="va">primary_diagnosis_code</span>,</span>
<span>      <span class="va">treatment_start_date</span>,</span>
<span>      <span class="va">treatment_end_date</span>,</span>
<span>      <span class="va">policy_commencement_date</span>,</span>
<span>      <span class="va">policy_termination_date</span>,</span>
<span>      <span class="va">claim_reported_date</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="performing-onehot-encoding-to-non-numeric-columns">Performing OneHot Encoding to Non-numeric columns<a class="anchor" aria-label="anchor" href="#performing-onehot-encoding-to-non-numeric-columns"></a>
</h3>
<ul>
<li><p>In this dataset, we had several categorical columns which cannot
be directly used in machine learning models, since machine learning
models usually require numerical inputs.</p></li>
<li><p>Hence one hot encoding is used to convert these categorical
columns into numerical format that can be used in machine learning
models.</p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dmy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/dummyVars.html" class="external-link">dummyVars</a></span><span class="op">(</span><span class="st">" ~ ."</span>, data <span class="op">=</span> <span class="va">data_w_triggers</span>, fullRank <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dmy</span>, newdata <span class="op">=</span> <span class="va">data_w_triggers</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="removing-features-with-sd-0-and-removing-trigger-information-features">Removing features with SD 0 and removing trigger information
features<a class="anchor" aria-label="anchor" href="#removing-features-with-sd-0-and-removing-trigger-information-features"></a>
</h3>
<ul>
<li><p>All the columns that were used to generate the flag columns are
no longer needed.</p></li>
<li><p>Hence they are removed from the dataset.</p></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drop1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"package_amount_trigger"</span>,</span>
<span>  <span class="st">"lower_age_limit"</span>,</span>
<span>  <span class="st">"upper_age_limit"</span>,</span>
<span>  <span class="st">"age_flag"</span>,</span>
<span>  <span class="st">"gender_triggerFemale"</span>,</span>
<span>  <span class="st">"claim_count_trigger"</span>,</span>
<span>  <span class="st">"close_prox_days"</span>,</span>
<span>  <span class="st">"hospital_empanelled_flag"</span>,</span>
<span>  <span class="st">"treatment_date_validity_flag"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data_w_triggers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">drop1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="feature-scaling">Feature scaling<a class="anchor" aria-label="anchor" href="#feature-scaling"></a>
</h3>
<ul>
<li><p>Feature scaling is an important step that helps to make sure all
the input features are on the same scale.</p></li>
<li><p>It’s important because some machine learning algorithms assume
that all the features have the same scale, and features with big values
might be given more importantance during the learning process.</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data_w_triggers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>    .cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"approved_allowed_amount"</span>,</span>
<span>      <span class="st">"no_of_days_stayed"</span>,</span>
<span>      <span class="st">"patient_age"</span>,</span>
<span>      <span class="st">"claim_count_pa"</span>,</span>
<span>      <span class="st">"claim_duration_days"</span>,</span>
<span>      <span class="st">"distance"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    .fns <span class="op">=</span> <span class="op">~</span> <span class="op">(</span><span class="va">.x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="checking-for-class-data-imbalance">Checking for class data Imbalance<a class="anchor" aria-label="anchor" href="#checking-for-class-data-imbalance"></a>
</h3>
<ul>
<li><p>Since fraud is a rare occurrence, the proportion of fraud cases
is much lesser than that of non fraud cases.</p></li>
<li><p>We first check for the presence of such class imbalance in this
dataset.</p></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.00000 0.00000 0.00000 0.02988 0.00000 1.00000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Class Distribution"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="02_mapping_triggers_to_data_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="splitting-train-and-test-data">Splitting train and test data<a class="anchor" aria-label="anchor" href="#splitting-train-and-test-data"></a>
</h3>
<ul>
<li><p>Splitting a dataset into a training set and a test set is crucial
to evaluate the performance of a model on new, unseen data.</p></li>
<li><p>The training set is used to train the model, while the test set
is used to evaluate its performance.</p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">data_w_triggers</span> <span class="op">=</span> </span>
<span>  <span class="va">data_w_triggers</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"medical_service_provider_idhospital32"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital185"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital58"</span>,</span>
<span>  <span class="st">"primary_procedure_codeM100068"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital118"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital31"</span>,</span>
<span>  <span class="st">"hospital_locationlocation22"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital181"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital247"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital14"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital71"</span>,</span>
<span>  <span class="st">"hospital_locationlocation20"</span>,</span>
<span>  <span class="st">"patient_age"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital127"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital49"</span>,</span>
<span>  <span class="st">"hospital_locationlocation15"</span>,</span>
<span>  <span class="st">"medical_service_provider_idhospital188"</span>,</span>
<span>  <span class="st">"hospital_locationlocation12"</span>,</span>
<span>  <span class="st">"hospital_locationlocation13"</span>,</span>
<span>  <span class="st">"primary_procedure_codeM100008"</span>,</span>
<span>  <span class="st">"hospital_locationlocation19"</span>,</span>
<span>  <span class="st">"hospital_locationlocation14"</span>,</span>
<span>  <span class="st">"primary_procedure_codeM100009"</span>,</span>
<span>  <span class="st">"primary_procedure_codeM700004"</span>,</span>
<span>  <span class="st">"no_of_days_stayed"</span>,</span>
<span>  <span class="st">"residence_locationlocation5"</span>,</span>
<span>  <span class="st">"hospital_locationlocation5"</span>,</span>
<span>  <span class="st">"approved_allowed_amount"</span>,</span>
<span>  <span class="st">"hospital_locationlocation17"</span>,</span>
<span>  <span class="st">"primary_procedure_codeU100"</span>,</span>
<span>  <span class="st">"fraud"</span>,</span>
<span>  <span class="st">"claim_amount_flag"</span>,</span>
<span>  <span class="st">"hosp_days_flag"</span>,</span>
<span>  <span class="st">"gender_flag"</span>,</span>
<span>  <span class="st">"claim_count_flag"</span>,</span>
<span>  <span class="st">"close_prox_flag"</span>,</span>
<span>  <span class="st">"distance"</span>,</span>
<span>  <span class="st">"hospital_distance_flag"</span>,</span>
<span>  <span class="st">"claim_duration_days"</span>,</span>
<span>  <span class="st">"claim_reported_delay_flag"</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># randomly split data in r</span></span>
<span><span class="va">TrainingIndex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_w_triggers_train</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data_w_triggers</span><span class="op">[</span><span class="va">TrainingIndex</span>, <span class="op">]</span> <span class="co"># Training Set</span></span>
<span><span class="va">data_w_triggers_test</span> <span class="op">&lt;-</span> <span class="va">data_w_triggers</span><span class="op">[</span><span class="op">-</span><span class="va">TrainingIndex</span>, <span class="op">]</span> <span class="co"># Test Set</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adjusting-data-for-imbalance">Adjusting data for imbalance<a class="anchor" aria-label="anchor" href="#adjusting-data-for-imbalance"></a>
</h3>
<ul>
<li><p>As seen above, there is a class imbalance in this
dataset.</p></li>
<li><p>Adjusting the data for the imbalance is necessary in order to
ensure that the machine learning models are not biased towards the
majority class.</p></li>
<li><p>We used oversampling methods to handle the data imbalance to
ensure that there is no loss of data.</p></li>
</ul>
<div class="section level4">
<h4 id="adasyn">ADASYN<a class="anchor" aria-label="anchor" href="#adasyn"></a>
</h4>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/smotefamily/man/adas.html" class="external-link">ADAS</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">data_w_triggers_train</span>,</span>
<span>       <span class="va">data_w_triggers_train</span><span class="op">$</span><span class="va">fraud</span>,</span>
<span>       K <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adasyn_w_triggers_train</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">newData</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fraud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adasyn_w_triggers_train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   fraud count</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     <span style="text-decoration: underline;">74</span>126</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1     <span style="text-decoration: underline;">74</span>088</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">adasyn_w_triggers_test</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/smotefamily/man/adas.html" class="external-link">ADAS</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">data_w_triggers_test</span>,</span>
<span>       <span class="va">data_w_triggers_test</span><span class="op">$</span><span class="va">fraud</span>,</span>
<span>       K <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fraud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adasyn_w_triggers_test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   fraud count</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     <span style="text-decoration: underline;">31</span>804</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1     <span style="text-decoration: underline;">31</span>844</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="smote">SMOTE<a class="anchor" aria-label="anchor" href="#smote"></a>
</h4>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_w_triggers_train</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">data_w_triggers_train</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 33.10307</span></span>
<span></span>
<span><span class="va">smote_w_triggers_train</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/smotefamily/man/SMOTE.html" class="external-link">SMOTE</a></span><span class="op">(</span></span>
<span>    <span class="va">data_w_triggers_train</span>,</span>
<span>    <span class="va">data_w_triggers_train</span><span class="op">$</span><span class="va">fraud</span> ,</span>
<span>    K <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    dup_size <span class="op">=</span> <span class="fl">18</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fraud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">smote_w_triggers_train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   fraud count</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     <span style="text-decoration: underline;">74</span>126</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1     <span style="text-decoration: underline;">43</span>871</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_w_triggers_test</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">data_w_triggers_test</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 34.33753</span></span>
<span></span>
<span><span class="va">smote_w_triggers_test</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/smotefamily/man/SMOTE.html" class="external-link">SMOTE</a></span><span class="op">(</span></span>
<span>    <span class="va">data_w_triggers_test</span>,</span>
<span>    <span class="va">data_w_triggers_test</span><span class="op">$</span><span class="va">fraud</span> ,</span>
<span>    K <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    dup_size <span class="op">=</span> <span class="fl">18</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fraud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">smote_w_triggers_test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   fraud count</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     <span style="text-decoration: underline;">31</span>804</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1     <span style="text-decoration: underline;">18</span>126</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="mwmote">MWMOTE<a class="anchor" aria-label="anchor" href="#mwmote"></a>
</h4>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mwmote_w_triggers_train</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/imbalance/man/mwmote.html" class="external-link">mwmote</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">data_w_triggers_train</span>,</span>
<span>    numInstances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_w_triggers_train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">data_w_triggers_train</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span>,</span>
<span>    classAttr <span class="op">=</span> <span class="st">"fraud"</span>,</span>
<span>    kNoisy <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    kMajority <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    kMinority <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    cmax <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    cclustering <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fraud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mwmote_w_triggers_train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   fraud  count</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     <span style="text-decoration: underline;">105</span>930</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      <span style="text-decoration: underline;">75</span>080</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mwmote_w_triggers_test</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/imbalance/man/mwmote.html" class="external-link">mwmote</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">data_w_triggers_test</span>,</span>
<span>    numInstances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_w_triggers_test</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">data_w_triggers_test</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span>,</span>
<span>    classAttr <span class="op">=</span> <span class="st">"fraud"</span>,</span>
<span>    kNoisy <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    kMajority <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    kMinority <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    cmax <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    cclustering <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">data_w_triggers</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fraud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mwmote_w_triggers_test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   fraud  count</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     <span style="text-decoration: underline;">105</span>930</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      <span style="text-decoration: underline;">34</span>113</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rose">ROSE<a class="anchor" aria-label="anchor" href="#rose"></a>
</h4>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#chose seed 100</span></span>
<span><span class="co">#The N variable is the total number that will be generated</span></span>
<span><span class="co">#N should essentially be sum of both fraud and non fraud</span></span>
<span><span class="va">rose_w_triggers_train</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ROSE/man/ovun.sample.html" class="external-link">ovun.sample</a></span><span class="op">(</span></span>
<span>    <span class="va">fraud</span> <span class="op">~</span> <span class="va">.</span> ,</span>
<span>    data <span class="op">=</span> <span class="va">data_w_triggers_train</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"over"</span>,</span>
<span>    N <span class="op">=</span> <span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_w_triggers_train</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">data_w_triggers_train</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fraud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">rose_w_triggers_train</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     0     1 </span></span>
<span><span class="co">#&gt; 74126 74126</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">rose_w_triggers_train</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Class Distribution"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="02_mapping_triggers_to_data_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#chose seed 100</span></span>
<span><span class="co">#The N variable is the total number that will be generated</span></span>
<span><span class="co">#N should essentially be sum of both fraud and non fraud</span></span>
<span><span class="va">rose_w_triggers_test</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ROSE/man/ovun.sample.html" class="external-link">ovun.sample</a></span><span class="op">(</span></span>
<span>    <span class="va">fraud</span> <span class="op">~</span> <span class="va">.</span> ,</span>
<span>    data <span class="op">=</span> <span class="va">data_w_triggers_test</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"over"</span>,</span>
<span>    N <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_w_triggers_test</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">data_w_triggers_test</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fraud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">rose_w_triggers_test</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     0     1 </span></span>
<span><span class="co">#&gt; 31804 31804</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">rose_w_triggers_test</span><span class="op">$</span><span class="va">fraud</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Class Distribution"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="02_mapping_triggers_to_data_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by SSSIHL -DMACS.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
