<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SSSIHLCASFraudClassifyR">
<title>Fraud Classification with Random Forest • SSSIHLCASFraudClassifyR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fraud Classification with Random Forest">
<meta property="og:description" content="SSSIHLCASFraudClassifyR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SSSIHLCASFraudClassifyR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/SSSIHLCASFraudClassifyR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_data_pre_processing.html">Data Pre-processing</a>
    <a class="dropdown-item" href="../articles/02_mapping_triggers_to_data.html">Mapping Triggers to Data</a>
    <a class="dropdown-item" href="../articles/03_fraud_classification_decision_trees.html">Fraud Classification with Decision Trees</a>
    <a class="dropdown-item" href="../articles/04_fraud_classification_glm.html">Fraud Classification with GLM</a>
    <a class="dropdown-item" href="../articles/05_fraud_classification_naive_bayes.html">Fraud Classification with Naive Bayes</a>
    <a class="dropdown-item" href="../articles/06_fraud_classification_random_forest.html">Fraud Classification with Random Forest</a>
    <a class="dropdown-item" href="../articles/07_fraud_classification_xg_boost.html">Fraud Classification with XG Boost</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fraud Classification with Random Forest</h1>
            
      
      
      <div class="d-none name"><code>06_fraud_classification_random_forest.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="improving-fit-of-a-random-forest-model">Improving fit of a Random Forest model<a class="anchor" aria-label="anchor" href="#improving-fit-of-a-random-forest-model"></a>
</h3>
<p>One can add triggers to a standard claims dataset to improve your
model’s predictability of fraud. We illustrate this using a random
forest model in this vignette. In the data pre-processing vignette, we
treated the data imbalance in claims data using 4 different types of
data imbalance techniques - ADASYN, SMOTE, MWMOTE and ROSE.</p>
<p>Random Forest is an ensemble supervised learning algorithm used for
classification and regression. In this scenario we are using it for a
binary classification problem. The random forest algorithm is a way to
make predictions based on many decision trees.</p>
<p>It creates multiple decision trees by randomly selecting subsets of
the data and features. Then, each tree is trained on a different subset
of the data and features, and when a new data point is presented, each
tree predicts the class label independently. Finally, the predictions of
all the trees are combined to get the final prediction. Random forest is
often used to improve the performance and reduce overfitting of decision
trees.</p>
</div>
<div class="section level3">
<h3 id="importing-required-libraries">Importing required libraries<a class="anchor" aria-label="anchor" href="#importing-required-libraries"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart" class="external-link">rpart</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://expasy.org/tools/pROC/" class="external-link">pROC</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">randomForest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PRROC</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-random-forest-model-function">Creating random forest model function<a class="anchor" aria-label="anchor" href="#creating-random-forest-model-function"></a>
</h2>
<ul>
<li><p>We create a function for implementing the Random Forest model in
order to easily apply it on the various datasets.</p></li>
<li><p>The function takes two arguments: train dataset and test
dataset.</p></li>
<li><p>The response variable is “fraud” and all other variables are
considered as predictor variables.</p></li>
<li><p>Overall this function fits a Random Forest model for binary
classification of fraud or non-fraud and evaluates its performance using
various metrics.</p></li>
<li><p>F2 score is used as the most appropriate metric to compare the
model-fit results. This is because we want to improve identification of
fraud.</p></li>
<li><p>It also produces plots of the random forest model’s performance
and variable importance.</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">random_forest</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data_train</span>, <span class="va">data_test</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># train the random forest model</span></span>
<span>  <span class="va">classifier_rf</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">fraud</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span>, ntree <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># predict probabilities on the test set</span></span>
<span>  <span class="va">y_prob</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">classifier_rf</span>, newdata <span class="op">=</span> <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># calculate ROC AUC and PR AUC</span></span>
<span>  <span class="va">roc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">data_test</span><span class="op">$</span><span class="va">fraud</span>, <span class="va">y_prob</span><span class="op">)</span></span>
<span>  <span class="va">pr_obj</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/PRROC/man/pr.curve.html" class="external-link">pr.curve</a></span><span class="op">(</span>scores.class0 <span class="op">=</span> <span class="va">y_prob</span>,</span>
<span>             weights.class0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data_test</span><span class="op">$</span><span class="va">fraud</span> <span class="op">==</span> <span class="st">"1"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># determine threshold using ROC curve</span></span>
<span>  <span class="va">threshold</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/coords.html" class="external-link">coords</a></span><span class="op">(</span><span class="va">roc_obj</span>, <span class="st">"best"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># classify test set based on threshold</span></span>
<span>  <span class="va">y_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">y_prob</span> <span class="op">&gt;</span> <span class="va">threshold</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Confusion Matrix</span></span>
<span>  <span class="va">c1</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html" class="external-link">confusionMatrix</a></span><span class="op">(</span><span class="va">data_test</span><span class="op">$</span><span class="va">fraud</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">y_pred</span><span class="op">)</span>,</span>
<span>                    mode <span class="op">=</span> <span class="st">"everything"</span>,</span>
<span>                    positive <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span></span>
<span>  <span class="va">c</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">c1</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"RF "</span>, <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">data_train</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="va">c1</span><span class="op">$</span><span class="va">overall</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>            <span class="va">c1</span><span class="op">$</span><span class="va">byClass</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span><span class="op">]</span>,</span>
<span>            <span class="va">roc_obj</span><span class="op">$</span><span class="va">auc</span>,</span>
<span>            <span class="va">pr_obj</span><span class="op">$</span><span class="va">auc.integral</span></span>
<span>          <span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Plotting model</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">classifier_rf</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Importance plot</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/importance.html" class="external-link">importance</a></span><span class="op">(</span><span class="va">classifier_rf</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Variable importance plot</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/varImpPlot.html" class="external-link">varImpPlot</a></span><span class="op">(</span><span class="va">classifier_rf</span>, top <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">c</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Method+dataset"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span> <span class="op">=</span> <span class="st">"ROC-AUC"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span> <span class="op">=</span> <span class="st">"PR-AUC"</span></span>
<span>  </span>
<span>  <span class="va">c</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="op">-</span><span class="va">`Method+dataset`</span>, .fns <span class="op">=</span> <span class="va">as.numeric</span><span class="op">)</span>,</span>
<span>      trigger <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">`Method+dataset`</span>, <span class="st">"wo"</span><span class="op">)</span>, <span class="st">"N"</span>, <span class="st">"Y"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">`Method+dataset`</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"method"</span>, <span class="st">"NA_1"</span><span class="op">)</span>, <span class="st">" "</span>, remove <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">NA_1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"imbalance"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`F2 Score` <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">Precision</span> <span class="op">*</span> <span class="va">Recall</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">Precision</span> <span class="op">+</span> <span class="va">Recall</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">imbalance</span>,<span class="va">trigger</span> ,<span class="va">`F2 Score`</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="applying-the-function-to-the-datasets">Applying the function to the datasets<a class="anchor" aria-label="anchor" href="#applying-the-function-to-the-datasets"></a>
</h3>
<p>The function is now applied to each of the datasets which are
adjusted for the data imbalance using the ADASYN, SMOTE, MWMOTE and
ROSE.</p>
<p><strong>In brief about these methods:</strong></p>
<ul>
<li><p>ADASYN(Adaptive Synthetic Sampling) generates synthetic data
points for the minority class in imbalanced datasets, creating more
samples in underrepresented regions to improve model
performance.</p></li>
<li><p>SMOTE (Synthetic Minority Over-sampling Technique) generates
synthetic data points for the minority class in imbalanced datasets by
interpolating between minority class examples to create new
samples.</p></li>
<li><p>MWMOTE(Majority Weighted Minority Oversampling Technique) is a
modification of SMOTE that aims to address the issue of noisy examples
by adding a weighting factor to each minority class example based on its
level of noise.</p></li>
<li><p>ROSE (Random Over-Sampling Examples) generates synthetic data
points for the minority class by randomly selecting a sample from the
minority class.</p></li>
</ul>
<div class="section level4">
<h4 id="adasyn">ADASYN<a class="anchor" aria-label="anchor" href="#adasyn"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adasyn_wo_triggers</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">random_forest</span><span class="op">(</span><span class="va">adasyn_wo_triggers_train</span>,</span>
<span>                <span class="va">adasyn_wo_triggers_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-6-1.png" width="700"><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adasyn_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">random_forest</span><span class="op">(</span><span class="va">adasyn_w_triggers_train</span>,</span>
<span>                <span class="va">adasyn_w_triggers_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-7-1.png" width="700"><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="smote">SMOTE<a class="anchor" aria-label="anchor" href="#smote"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smote_wo_triggers</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">random_forest</span><span class="op">(</span><span class="va">smote_wo_triggers_train</span>,</span>
<span>                <span class="va">smote_wo_triggers_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-8-1.png" width="700"><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smote_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">random_forest</span><span class="op">(</span><span class="va">smote_w_triggers_train</span>,</span>
<span>                <span class="va">smote_w_triggers_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-9-1.png" width="700"><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="mwmote">MWMOTE<a class="anchor" aria-label="anchor" href="#mwmote"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mwmote_wo_triggers</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">random_forest</span><span class="op">(</span><span class="va">mwmote_wo_triggers_train</span>,</span>
<span>                <span class="va">mwmote_wo_triggers_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-10-1.png" width="700"><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mwmote_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">random_forest</span><span class="op">(</span><span class="va">mwmote_w_triggers_train</span>,</span>
<span>                <span class="va">mwmote_w_triggers_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-11-1.png" width="700"><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="rose">ROSE<a class="anchor" aria-label="anchor" href="#rose"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rose_wo_triggers</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">random_forest</span><span class="op">(</span><span class="va">rose_wo_triggers_train</span>,</span>
<span>                <span class="va">rose_wo_triggers_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-12-1.png" width="700"><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rose_w_triggers</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">random_forest</span><span class="op">(</span><span class="va">rose_w_triggers_train</span>,</span>
<span>                <span class="va">rose_w_triggers_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-13-1.png" width="700"><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="results-comparison">Results comparison<a class="anchor" aria-label="anchor" href="#results-comparison"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">adasyn_wo_triggers</span>,</span>
<span>  <span class="va">adasyn_w_triggers</span>,</span>
<span>  <span class="va">smote_wo_triggers</span>,</span>
<span>  <span class="va">smote_w_triggers</span>,</span>
<span>  <span class="va">mwmote_wo_triggers</span>,</span>
<span>  <span class="va">mwmote_w_triggers</span>,</span>
<span>  <span class="va">rose_wo_triggers</span>,</span>
<span>  <span class="va">rose_w_triggers</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">imbalance</span>, <span class="va">trigger</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">trigger</span>, y <span class="op">=</span> <span class="va">`F2 Score`</span>, fill <span class="op">=</span> <span class="va">trigger</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">'identity'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">imbalance</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_fraud_classification_random_forest_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>As can be seen from the above charts, the models with the trigger
fields have shown better predictability compared to those without
triggers.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by SSSIHL -DMACS.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
